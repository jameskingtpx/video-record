{% extends "layouts/main.html" %}
{% block pageTitle %}
Video – {{ serviceName }} – GOV.UK Prototype Kit
{% endblock %}
{% block beforeContent %}
{{ govukBackLink({
text: "Back",
href: "javascript:window.history.back()"
}) }}
{% endblock %}

{% set pageTitle = "Record your video" %}
{% block content %}
<div data-module="videoRecorder">
  <div class="es-pane" id="recordingScreen">
    <div class="govuk-grid-row">
      <div class="govuk-grid-column-two-thirds">
        <h1 class="govuk-heading-l">{{ pageTitle }}</h1>
        <p>In your video:</p>
        <ul class="govuk-list govuk-list--bullet">
          <li>you do not need to speak</li>
          <li>don’t worry about how you look</li>
          <li>make sure your whole face is visible and well lit</li>
          <li>make sure you are not wearing a hat or sunglasses</li>
        </ul>
        <div
                class="videoRecorder__container"
                id="videoContainer"
                data-video-upload-url="{{ videoUploadUrl }}"
                data-submission-id="{{ submissionId }}"
                {% if frameUploadUrl.length > 0 %}
          data-image-upload-url="{{ frameUploadUrl[0] }}"
          {% endif %}
          >
          <div class="videoRecorder__videoWrap">
            <video id="video" class="videoRecorder__video" autoplay muted playsinline></video>
            <canvas id="canvas" hidden></canvas>
            <div id="statusTag" class="govuk-tag govuk-tag--red videoRecorder__tag"></div>
          </div>
          <button id="startBtn" class="govuk-button" disabled aria-disabled="true">Start recording</button>
        </div>
        <div class="videoRecorder__error" id="errorMessage" hidden>
          <div class="govuk-inset-text es-inset-text--error">
            <h2 class="govuk-heading-m es-heading--error">You need to accept permissions on your device</h2>
            <p>
              We are unable to access your camera to record a video. Check your browser settings and permissions. If
              you are having trouble using this service, contact your probation officer.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="es-pane" id="errorScreen" hidden aria-hidden="true">
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <h1 class="govuk-heading-l">We cannot confirm this is you because an error occured</h1>
      <p>We have checked and we cannot confirm this is you. You can try recording again.</p>
      <p class="govuk-!-font-weight-bold">In your video, make sure:</p>
      <ul class="govuk-list govuk-list--bullet">
        <li>you are in a well lit area</li>
        <li>you are in front of a plain background</li>
        <li>your face is in the frame</li>
        <li>you are not wearing a hat or sunglasses</li>
      </ul>
      <div class="govuk-button-group">
        <a class="govuk-button" role="button" href="">Try recording your video again</a>
      </div>
    </div>
  </div>
</div>
<div class="es-pane" id="loadingScreen" hidden aria-hidden="true">
  <div class="es-loader">
    <div class="es-loader__spinner" aria-live="polite" role="status"></div>
    <div class="es-loader__content">
      <h1 class="govuk-heading-m">Checking this is you</h1>
    </div>
  </div>
</div>
<div class="es-pane" id="matchScreen" hidden aria-hidden="true">
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <h1 class="govuk-heading-l">We have confirmed this is you</h1>
      <p>We have confirmed this is you. You can now continue to check your answers.</p>
      <div class="videoRecorder__videoWrap">
        <video class="videoRecorder__video-preview" id="matchPreview" controls>
          Your browser does not support video
        </video>
      </div>
      <div class="govuk-button-group">
        <a
                class="govuk-button"
                data-module="govuk-button"
                role="button"
                href="/submission/{{ submissionId }}/check-your-answers"
        >Continue</a
        >
      </div>
    </div>
  </div>
</div>
<div class="es-pane" id="noMatchScreen" hidden aria-hidden="true">
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <h1 class="govuk-heading-l">We cannot confirm this is you</h1>
      <p>We have checked and we cannot confirm this is you. You can try recording again or submit your video anyway.</p>
      <div class="videoRecorder__videoWrap">
        <video class="videoRecorder__video-preview" id="noMatchPreview" controls>
          Your browser does not support video
        </video>
      </div>
      <h2 class="govuk-heading-m">If you record your video again</h2>
      <p>In your video, make sure:</p>
      <ul class="govuk-list govuk-list--bullet">
        <li>you are in a well lit area</li>
        <li>you are in front of a plain background</li>
        <li>your face is in the frame</li>
        <li>you are not wearing a hat or sunglasses</li>
      </ul>
      <div class="govuk-button-group">
        <a class="govuk-button" role="button" href="">Record video again</a>
        <a
                class="govuk-button govuk-button--secondary"
                role="button"
                data-module="govuk-button"
                href="/submission/{{ submissionId }}/check-your-answers"
        >
          Submit video anyway
        </a>
      </div>
    </div>
  </div>
</div>
{% endblock %}